angular.module("App",["ui.router"]).config(function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/slide01");for(var slideCount=30,i=1;slideCount+1>i;i++){var slide=10>i?"0"+i:i;$stateProvider.state(""+slide,{url:"/slide"+slide,templateUrl:"views/slide"+slide+".html",controller:"slide"+slide})}}),angular.module("App").factory("Data",function(){function get(callback){data&&(console.log("DATA"),callback(data)),d3.csv("data.csv",function(dataset){data=dataset,callback(dataset)})}function initDataset(dataset){var sorted=_.sortBy(dataset,function(d){return parseInt(d.maxCode)});return data=d3.nest().key(function(d){return d.status}).entries(sorted)}function initSvg(el){var margin={top:10,right:10,bottom:65,left:65},width=$(el).width()-margin.left-margin.right,height=400-margin.top-margin.bottom,svg=d3.select(el).append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")");return{margin:margin,width:width,height:height,svg:svg}}function initScales(data,width,height){var x=d3.scale.ordinal().domain(_.map(data,function(d){return d.key})).rangeRoundBands([0,width],.1),y=d3.scale.linear().range([height,0]);return{x:x,y:y}}function initAxes(scales){var xAxis=d3.svg.axis().scale(scales.x).orient("bottom").ticks(21),yAxis=d3.svg.axis().orient("left");return{x:xAxis,y:yAxis}}var data=!1;return{get:get,initDataset:initDataset,initSvg:initSvg,initScales:initScales,initAxes:initAxes}}),angular.module("App").controller("main",function($scope,$document,$state){var stateCount=$state.get().length-1;$scope.slides=_.sortBy($state.get(),function(a){return parseInt(a.name)}),$scope.slides.splice($scope.slides.length-1,1),$scope.slides.isCurrent=function(slide){return slide.name===$state.current.name},$scope.slides.click=function(slide){$state.go(slide.name)},$document.bind("keydown",function(event){var state=parseInt($state.current.name);39==event.keyCode?(state+=1,state>stateCount&&(state=1),state=10>state?"0"+state:""+state,$state.go(state)):37==event.keyCode&&(state-=1,1>state&&(state=stateCount),state=10>state?"0"+state:""+state,$state.go(state))})}).controller("slide01").controller("slide02",function($scope,Data){}).controller("slide03").controller("slide04").controller("slide05").controller("slide06"),angular.module("App").controller("main",function($scope,$document,$state){var stateCount=$state.get().length-1;$scope.slides=_.sortBy($state.get(),function(a){return parseInt(a.name)}),$scope.slides.splice($scope.slides.length-1,1),$scope.slides.isCurrent=function(slide){return slide.name===$state.current.name},$scope.slides.click=function(slide){$state.go(slide.name)},$document.bind("keydown",function(event){var state=parseInt($state.current.name);39==event.keyCode?(state+=1,state>stateCount&&(state=1),state=10>state?"0"+state:""+state,$state.go(state)):37==event.keyCode&&(state-=1,1>state&&(state=stateCount),state=10>state?"0"+state:""+state,$state.go(state))})}).controller("slide01",function(){}).controller("slide02",function(){}).controller("slide03",function(){}).controller("slide04",function(){}).controller("slide05",function(){}).controller("slide06",function(){}),angular.module("App").controller("slide07",function(){}).controller("slide08",function($scope){data=[3,5,2,4,1],d3.select("#canvas").selectAll("circle").data(data).enter().append("circle").attr("cx",function(d,i){return 30*(i+1)}).attr("cy",function(d,i){return 10*d}).attr("r",function(d,i){return 3*d})}).controller("slide09",function(){}).controller("slide10",function(){}).controller("slide11",function(){}).controller("slide12",function(){}).controller("slide13",function(){}).controller("slide14",function($scope,Data){Data.initSvg("#plot")}).controller("slide15",function(){}).controller("slide16",function($scope,Data){Data.get(function(dataset){$("svg").remove();var data=Data.initDataset(dataset),layout=Data.initSvg("#plot"),scales=Data.initScales(data,layout.width,layout.height),axes=Data.initAxes(scales);layout.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+layout.height+")").call(axes.x),layout.svg.append("g").attr("class","y axis")})}).controller("slide17",function($scope,Data){Data.get(function(dataset){$("svg").remove();var data=Data.initDataset(dataset),layout=Data.initSvg("#plot"),scales=Data.initScales(data,layout.width,layout.height),axes=Data.initAxes(scales);layout.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+layout.height+")").call(axes.x),layout.svg.append("g").attr("class","y axis"),scales.y.domain([0,d3.max(data,function(d){return d.values.length})]),axes.y.scale(scales.y),d3.select(".y.axis").attr("transform","translate(-5,0)").call(axes.y).selectAll("g")})}),angular.module("App").controller("slide18",function($scope,Data){Data.get(function(dataset){$("svg").remove();var data=Data.initDataset(dataset),layout=Data.initSvg("#plot"),scales=Data.initScales(data,layout.width,layout.height),axes=Data.initAxes(scales);layout.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+(layout.height+5)+")").call(axes.x),layout.svg.append("g").attr("class","y axis"),scales.y.domain([0,d3.max(data,function(d){return d.values.length})]),axes.y.scale(scales.y),d3.select(".y.axis").attr("transform","translate(-5,0)").call(axes.y).selectAll("g"),layout.svg.selectAll("rect").data(data).enter().append("rect").attr("x",function(d){return scales.x(d.key)}).attr("width",scales.x.rangeBand()).attr("y",function(d){return scales.y(d.values.length)}).attr("height",function(d){return layout.height-scales.y(d.values.length)})})}).controller("slide19",function($scope,Data){Data.get(function(dataset){var sorted=_.sortBy(dataset,function(d){return parseInt(d.maxCode)}),data=d3.nest().key(function(d){return d.status}).key(function(d){return d.superkingdom}).entries(sorted);console.log(data)})}).controller("slide20",function(){}).controller("slide21",function(Data){function filter(d){for(f in filters){var filt=filters[f];if(filt="noFilter"===filt?"":filt,d[f].indexOf(filt)<0)return!1}return!0}var filters={species:"",clone:"Not available",protein:"Not available"};Data.get(function(dataset){var sorted=_.sortBy(dataset,function(d){return parseInt(d.maxCode)});d3.nest().key(function(d){return d.status}).key(function(d){return d.superkingdom}).entries(sorted.filter(filter))})}).controller("slide22",function(){}).controller("slide23",function(){}).controller("slide24",function(){}).controller("slide25",function(){}),angular.module("App").controller("slide26",function($scope,Data){function filter(d){for(f in filters){var filt=filters[f];if(filt="noFilter"===filt?"":filt,d[f].indexOf(filt)<0)return!1}return!0}function getFactors(data){var sorted=_.sortBy(data,function(d){return parseInt(d.maxCode)}),factors=_.map(sorted,function(d){return d.status});return _.unique(factors)}var filters={species:"",clone:"Not available",protein:"Not available"};Data.get(function(dataset){console.log(getFactors(dataset)),$("svg").remove();var layout=Data.initSvg("#plot"),groupBy=(d3.scale.ordinal().domain(_.map(dataset,function(d){return d.status})).rangeRoundBands([0,layout.width],.1),d3.scale.ordinal(),d3.scale.linear().range([layout.height,0]),"superkingdom"),sorted=_.sortBy(dataset,function(d){return parseInt(d.maxCode)});d3.nest().key(function(d){return d.status}).key(function(d){return d[groupBy]}).entries(sorted.filter(filter))})});